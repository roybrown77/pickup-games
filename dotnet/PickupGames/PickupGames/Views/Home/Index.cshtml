@model PickupGames.Models.GameModel
@{
    ViewBag.Title = "Index";
}

<section>
    <div class="content-wrapper">
        <label onclick="javascript:toggleCreateGameDisplay();" style="font-weight:bold; cursor:pointer">Create Game</label>
        <div id="creategame" class="title" style="display:none">
            @using (Ajax.BeginForm("CreateGame", "Home", FormMethod.Post, new AjaxOptions { OnSuccess = "createGameSuccess(data, status, xhr)" }, new { id = "creategameform" }))
            {
                <div class="modal-body">
                    @Html.ValidationSummary(false)

                    @Html.LabelFor(m => m.Name)
                    @Html.TextBoxFor(m => m.Name)

                    @Html.LabelFor(m => m.SportItems)
                    @Html.DropDownListFor(m => m.Sport, new SelectList(Model.SportItems, "Value", "Text"), "--Select Sport--")

                    @Html.LabelFor(m => m.StartTime)
                    @Html.EditorFor(m => m.StartTime, "Date")
                    
                    @Html.LabelFor(m => m.Location)
                    @Html.TextBoxFor(m => m.Location, new { style = "width:30em;" })
                </div>
                <div>
                    <input type="submit" class="btn btn-large btn-primary" value="Create!"/>
                </div>
            }
        </div>
    </div>
</section>
<section>
    <div id="map-canvas" style="width:500px; height:300px; background-color: white"/>
</section>

<script type="text/javascript">
    function initialize() {
        var mapOptions = {
            center: new google.maps.LatLng(-34.397, 150.644),
            zoom: 8
        };
        
        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
        
        var input = (document.getElementById('Location'));

        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.bindTo('bounds', map);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>

<script>
    function toggleCreateGameDisplay() {
        $('#creategame').toggle(500);
    };

    function createGame() {
        $.ajax({
            type: 'POST',
            url: "@Url.Action("CreateGame", "Home")",
            data: { gameModel: $("#creategame").serializeArray() },
            dataType: "json",
            success: function(data) {
                if (data.Status == "Success") {
                    $('#creategame').toggle(500);
                } else {
                }
            }
        });
    }
    
    function createGameSuccess(data, status, xhr) {
        if (data.Status == "Success") {
            $('#creategame').toggle(500);
        } else {
        }
    }
</script>

