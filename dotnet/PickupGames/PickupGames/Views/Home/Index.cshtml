@model PickupGames.Models.GameModel
@{
    ViewBag.Title = "Index";
    var gameModel = Model;
}

<section>
    <div class="content-wrapper">
        <div id="target"></div>
        <label onclick="javascript:toggleCreateGameDisplay();" style="font-weight:bold; cursor:pointer">Create Game</label>
        <div id="creategame" class="title" style="display:none">
            @using (Ajax.BeginForm("CreateGame", "Home", FormMethod.Post, new AjaxOptions { UpdateTargetId = "target", OnComplete = "createGameComplete(data, status, xhr)" }, new { id = "creategameform" }))
            {
                <div class="modal-body">
                    @Html.ValidationSummary(false, "Error:")

                    @Html.LabelFor(m => m.Name)
                    @Html.TextBoxFor(m => m.Name)

                    @Html.LabelFor(m => m.SportItems)
                    @Html.DropDownListFor(m => m.Sport, new SelectList(Model.SportItems, "Value", "Text"), "--Select Sport--")

                    @Html.LabelFor(m => m.StartTime)
                    @Html.EditorFor(m => m.StartTime, "Date")
                </div>
                <div>
                    <input type="submit" class="btn btn-large btn-primary" value="Create!"></input>
                </div>
            }
        </div>
    </div>
</section>

<script>
    function toggleCreateGameDisplay() {
        $('#creategame').toggle(500);
    };

    function createGame() {
        $.ajax({
            type: 'POST',
            url: "@Url.Action("CreateGame", "Home")",
            data: { gameModel: $("#creategame").serializeArray() },
            dataType: "json",
            success: function(data) {
                if (data.Status == "Success") {
                    $('#creategame').toggle(500);
                } else {
                }
            }
        });
    }
    
    function createGameComplete(data, status, xhr) {
        if (data.Status == "Success") {
            $('#creategame').toggle(500);
        } else {
        }
    }
</script>

